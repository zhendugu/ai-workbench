# Authority Layer Snapshots

**Authority**: docs/authority/*_FROZEN_001.md

This directory contains frozen snapshot bundles for Authority Layer facts.

## Directory Structure

Each frozen Company has its own directory:

```
snapshots/authority/<frozen_company_identifier>/
  ├── company.json          # Company authority facts
  ├── cells.json            # Array of Cell authority facts
  ├── roles.json            # Array of Role authority facts (attached to Cells)
  ├── topology.json         # Array of Relationship authority facts
  ├── methodology.json      # Methodology authority facts
  ├── freeze_record.json    # FreezeRecord authority facts
  └── manifest.json         # Snapshot metadata (no status/stage/progress)
```

## Snapshot Format

All JSON files must conform to Authority Layer schemas as defined in:
- `docs/authority/AUTH_COMPANY_SCHEMA_FROZEN_001.md`
- `docs/authority/AUTH_CELL_SCHEMA_FROZEN_001.md`
- `docs/authority/AUTH_ROLE_SCHEMA_FROZEN_001.md`
- `docs/authority/AUTH_TOPOLOGY_SCHEMA_FROZEN_001.md`
- `docs/authority/AUTH_METHODOLOGY_SCHEMA_FROZEN_001.md`
- `docs/authority/AUTH_FREEZE_RECORD_SCHEMA_FROZEN_001.md`

## Validation

All snapshots must pass validation using `@ai-workbench/authority` package:

```typescript
import { validateFrozenSnapshot } from '@ai-workbench/authority';

const snapshot = loadSnapshot(frozenCompanyIdentifier);
const result = validateFrozenSnapshot(snapshot);
if (!result.valid) {
  throw new Error(`Invalid snapshot: ${result.errors.map(e => e.message).join(', ')}`);
}
```

## Immutability

**Frozen snapshots are immutable.**

- Once created, snapshot files must not be modified
- Snapshot directories must not be deleted
- New versions must create new directories (with new frozen_company_identifier)

## Manifest

The `manifest.json` file contains snapshot metadata:

```json
{
  "snapshot_id": "FROZEN-COMP-{UUID}",
  "frozen_company_identifier": "FROZEN-COMP-{UUID}",
  "frozen_at": "2025-12-28T10:00:00Z",
  "frozen_by": "human-identifier",
  "schema_bundle_version": "001"
}
```

**Note**: Manifest does NOT contain:
- Status fields
- Stage/phase/progress indicators
- Version progress indicators
- State indicators

## Generation

Snapshots are generated by:
- `scripts/buildAuthoritySnapshot.ts` (for local generation)
- Design-Time Freeze operation (for production generation)

